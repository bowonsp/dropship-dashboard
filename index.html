<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Safe Dropship Automation Dashboard</title>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
  <div id="root"></div>
  
  <script type="text/babel">
    const { useState, useEffect } = React;

    function Dashboard() {
      const [activeTab, setActiveTab] = useState('dashboard');
      const [loading, setLoading] = useState(false);
      const [productQueue, setProductQueue] = useState([]);
      const [markupPercent, setMarkupPercent] = useState(35);
      
      const [trends] = useState([
        { id: 1, name: 'Fashion Muslim', growth: 145, volume: 125000, competition: 'medium', avgPrice: 85000 },
        { id: 2, name: 'Gadget Accessories', growth: 132, volume: 98000, competition: 'high', avgPrice: 45000 },
        { id: 3, name: 'Skincare Korea', growth: 128, volume: 156000, competition: 'high', avgPrice: 120000 },
        { id: 4, name: 'Alat Dapur', growth: 118, volume: 78000, competition: 'medium', avgPrice: 65000 },
        { id: 5, name: 'Mainan Edukasi', growth: 115, volume: 67000, competition: 'low', avgPrice: 95000 }
      ]);
      
      const [analytics] = useState({
        totalProducts: 38,
        totalRevenue: 4350000,
        totalProfit: 1341000,
        todayPosted: 12,
        weeklyGrowth: 18.5
      });

      const handleRefresh = () => {
        setLoading(true);
        setTimeout(() => {
          setLoading(false);
          alert('‚úÖ Data berhasil di-refresh!');
        }, 1000);
      };

      const handleExport = () => {
        const approved = productQueue.filter(p => p.status === 'approved');
        if (approved.length === 0) {
          alert('‚ùå Tidak ada produk yang di-approve untuk di-export!');
          return;
        }
        
        const data = {
          products: approved,
          safetySettings: {
            maxPostPerDay: 15,
            minDelaySeconds: 3,
            maxDelaySeconds: 8,
            workingHoursStart: 8,
            workingHoursEnd: 22
          },
          exportedAt: new Date().toISOString()
        };
        
        const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `dropship-export-${Date.now()}.json`;
        a.click();
        
        alert(`‚úÖ ${approved.length} produk berhasil di-export!`);
      };

      const addToQueue = (trend) => {
        const modalPrice = trend.avgPrice * 0.7;
        const sellingPrice = modalPrice + (modalPrice * markupPercent / 100);
        const profit = sellingPrice - modalPrice;
        
        const newProduct = {
          id: Date.now(),
          productName: `${trend.name} Premium`,
          category: trend.name,
          modalPrice: Math.round(modalPrice),
          sellingPrice: Math.round(sellingPrice),
          profit: Math.round(profit),
          status: 'pending',
          addedAt: new Date().toLocaleString('id-ID')
        };
        
        setProductQueue([...productQueue, newProduct]);
        alert(`‚úÖ "${newProduct.productName}" ditambahkan ke queue!`);
      };

      const approveProduct = (id) => {
        setProductQueue(productQueue.map(p => 
          p.id === id ? { ...p, status: 'approved' } : p
        ));
      };

      const rejectProduct = (id) => {
        setProductQueue(productQueue.map(p => 
          p.id === id ? { ...p, status: 'rejected' } : p
        ));
      };

      const removeProduct = (id) => {
        setProductQueue(productQueue.filter(p => p.id !== id));
      };

      return (
        <div className="max-w-7xl mx-auto p-4">
          {/* Header */}
          <div className="bg-white rounded-xl shadow-lg p-6 mb-6">
            <div className="flex items-center justify-between mb-4">
              <div>
                <h1 className="text-3xl font-bold text-gray-800">
                  üõ°Ô∏è Safe Dropship Automation
                </h1>
                <p className="text-gray-600 mt-2">Full automation dengan keamanan marketplace terjamin</p>
              </div>
              <button
                onClick={handleRefresh}
                disabled={loading}
                className="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition disabled:opacity-50"
              >
                {loading ? '‚è≥ Loading...' : 'üîÑ Refresh'}
              </button>
            </div>
            
            {/* Tabs */}
            <div className="flex gap-2 overflow-x-auto pb-2">
              {[
                { id: 'dashboard', label: 'üìä Dashboard' },
                { id: 'trends', label: 'üî• Trends' },
                { id: 'analytics', label: 'üìà Analytics' },
                { id: 'queue', label: `‚úÖ Queue (${productQueue.length})` }
              ].map(tab => (
                <button
                  key={tab.id}
                  onClick={() => setActiveTab(tab.id)}
                  className={`px-4 py-2 rounded-lg font-medium transition whitespace-nowrap ${
                    activeTab === tab.id 
                      ? 'bg-blue-600 text-white' 
                      : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                  }`}
                >
                  {tab.label}
                </button>
              ))}
            </div>
          </div>

          {/* Dashboard Tab */}
          {activeTab === 'dashboard' && (
            <div className="space-y-6">
              {/* Stats */}
              <div className="grid grid-cols-1 md:grid-cols-4 gap-4">
                <div className="bg-white rounded-lg shadow p-4">
                  <p className="text-gray-600 text-sm">Total Products</p>
                  <p className="text-2xl font-bold text-blue-600 mt-2">{analytics.totalProducts}</p>
                  <p className="text-xs text-green-600 mt-1">+{analytics.weeklyGrowth}% this week</p>
                </div>
                <div className="bg-white rounded-lg shadow p-4">
                  <p className="text-gray-600 text-sm">Total Revenue</p>
                  <p className="text-xl font-bold text-green-600 mt-2">
                    Rp {(analytics.totalRevenue/1000).toFixed(0)}k
                  </p>
                </div>
                <div className="bg-white rounded-lg shadow p-4">
                  <p className="text-gray-600 text-sm">Total Profit</p>
                  <p className="text-xl font-bold text-purple-600 mt-2">
                    Rp {(analytics.totalProfit/1000).toFixed(0)}k
                  </p>
                </div>
                <div className="bg-white rounded-lg shadow p-4">
                  <p className="text-gray-600 text-sm">Posted Today</p>
                  <p className="text-2xl font-bold text-orange-600 mt-2">{analytics.todayPosted}/15</p>
                </div>
              </div>

              {/* Safety Banner */}
              <div className="bg-gradient-to-r from-green-50 to-emerald-50 border-2 border-green-200 rounded-xl p-6">
                <h3 className="text-xl font-bold text-green-800 mb-2">
                  üõ°Ô∏è Safety Mode: ACTIVE
                </h3>
                <p className="text-green-700 text-sm mb-4">
                  Sistem berjalan dengan proteksi penuh terhadap ToS marketplace
                </p>
                <div className="grid md:grid-cols-3 gap-4">
                  <div className="bg-white rounded-lg p-3 border border-green-200">
                    <p className="text-sm text-gray-600">Daily Limit</p>
                    <p className="text-lg font-bold text-green-600">15 produk/hari</p>
                  </div>
                  <div className="bg-white rounded-lg p-3 border border-green-200">
                    <p className="text-sm text-gray-600">Random Delays</p>
                    <p className="text-lg font-bold text-green-600">3-8 detik</p>
                  </div>
                  <div className="bg-white rounded-lg p-3 border border-green-200">
                    <p className="text-sm text-gray-600">Working Hours</p>
                    <p className="text-lg font-bold text-green-600">8:00-22:00</p>
                  </div>
                </div>
              </div>
            </div>
          )}

          {/* Trends Tab */}
          {activeTab === 'trends' && (
            <div className="bg-white rounded-xl shadow-lg overflow-hidden">
              <div className="p-6 border-b bg-gradient-to-r from-blue-600 to-indigo-600">
                <h2 className="text-xl font-bold text-white">üî• Trending Categories</h2>
                <p className="text-blue-100 text-sm mt-1">Klik "Add to Queue" untuk menambahkan produk</p>
              </div>
              <div className="overflow-x-auto">
                <table className="w-full">
                  <thead className="bg-gray-50">
                    <tr>
                      <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Rank</th>
                      <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Category</th>
                      <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Growth</th>
                      <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Volume</th>
                      <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Competition</th>
                      <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Action</th>
                    </tr>
                  </thead>
                  <tbody className="divide-y divide-gray-200">
                    {trends.map((trend, idx) => (
                      <tr key={trend.id} className="hover:bg-gray-50">
                        <td className="px-6 py-4">
                          <span className={`font-bold ${idx < 3 ? 'text-yellow-600' : 'text-gray-500'}`}>
                            #{idx + 1}
                          </span>
                        </td>
                        <td className="px-6 py-4 font-medium text-gray-900">{trend.name}</td>
                        <td className="px-6 py-4 text-green-600 font-semibold">{trend.growth}%</td>
                        <td className="px-6 py-4">{trend.volume.toLocaleString('id-ID')}</td>
                        <td className="px-6 py-4">
                          <span className={`px-3 py-1 rounded-full text-xs font-medium ${
                            trend.competition === 'low' ? 'bg-green-100 text-green-700' :
                            trend.competition === 'medium' ? 'bg-yellow-100 text-yellow-700' :
                            'bg-red-100 text-red-700'
                          }`}>
                            {trend.competition}
                          </span>
                        </td>
                        <td className="px-6 py-4">
                          <button
                            onClick={() => addToQueue(trend)}
                            className="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition text-sm"
                          >
                            Add to Queue
                          </button>
                        </td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>
            </div>
          )}

          {/* Analytics Tab */}
          {activeTab === 'analytics' && (
            <div className="bg-white rounded-xl shadow-lg p-6">
              <h2 className="text-2xl font-bold mb-6">üìà Sales Analytics</h2>
              <div className="grid md:grid-cols-2 gap-6">
                <div className="border rounded-lg p-4">
                  <h3 className="font-semibold mb-3">Performance Overview</h3>
                  <div className="space-y-2">
                    <div className="flex justify-between">
                      <span className="text-gray-600">Conversion Rate</span>
                      <span className="font-bold text-blue-600">2.8%</span>
                    </div>
                    <div className="flex justify-between">
                      <span className="text-gray-600">Avg Order Value</span>
                      <span className="font-bold text-green-600">Rp 121.389</span>
                    </div>
                    <div className="flex justify-between">
                      <span className="text-gray-600">Total Orders</span>
                      <span className="font-bold text-purple-600">38</span>
                    </div>
                  </div>
                </div>
                <div className="border rounded-lg p-4">
                  <h3 className="font-semibold mb-3">Growth Metrics</h3>
                  <div className="space-y-2">
                    <div className="flex justify-between">
                      <span className="text-gray-600">Weekly Growth</span>
                      <span className="font-bold text-green-600">+{analytics.weeklyGrowth}%</span>
                    </div>
                    <div className="flex justify-between">
                      <span className="text-gray-600">New Products</span>
                      <span className="font-bold text-blue-600">12 this week</span>
                    </div>
                    <div className="flex justify-between">
                      <span className="text-gray-600">Active Listings</span>
                      <span className="font-bold text-purple-600">35</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          )}

          {/* Queue Tab */}
          {activeTab === 'queue' && (
            <div className="bg-white rounded-xl shadow-lg p-6">
              <div className="flex justify-between items-center mb-6">
                <h2 className="text-2xl font-bold">‚úÖ Product Queue Manager</h2>
                <button
                  onClick={handleExport}
                  disabled={productQueue.filter(p => p.status === 'approved').length === 0}
                  className="bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition disabled:opacity-50"
                >
                  üì• Export Approved ({productQueue.filter(p => p.status === 'approved').length})
                </button>
              </div>

              {productQueue.length === 0 ? (
                <div className="text-center py-12 text-gray-500">
                  <div className="text-6xl mb-4">üì¶</div>
                  <p className="text-lg font-medium">Queue kosong</p>
                  <p className="text-sm mt-2">Tambahkan produk dari tab Trends</p>
                </div>
              ) : (
                <div className="space-y-4">
                  {productQueue.map(item => (
                    <div key={item.id} className="border rounded-lg p-4">
                      <div className="flex justify-between items-start mb-3">
                        <div>
                          <h3 className="font-bold text-lg">{item.productName}</h3>
                          <p className="text-sm text-gray-600">{item.category} ‚Ä¢ {item.addedAt}</p>
                        </div>
                        <span className={`px-3 py-1 rounded-full text-xs font-medium ${
                          item.status === 'approved' ? 'bg-green-100 text-green-700' :
                          item.status === 'rejected' ? 'bg-red-100 text-red-700' :
                          'bg-yellow-100 text-yellow-700'
                        }`}>
                          {item.status}
                        </span>
                      </div>
                      <div className="grid md:grid-cols-3 gap-4 bg-gray-50 rounded p-3 mb-3">
                        <div>
                          <p className="text-sm text-gray-600">Modal</p>
                          <p className="font-bold text-red-600">Rp {item.modalPrice.toLocaleString('id-ID')}</p>
                        </div>
                        <div>
                          <p className="text-sm text-gray-600">Harga Jual</p>
                          <p className="font-bold text-green-600">Rp {item.sellingPrice.toLocaleString('id-ID')}</p>
                        </div>
                        <div>
                          <p className="text-sm text-gray-600">Profit</p>
                          <p className="font-bold text-blue-600">Rp {item.profit.toLocaleString('id-ID')}</p>
                        </div>
                      </div>
                      <div className="flex gap-2">
                        {item.status === 'pending' && (
                          <>
                            <button
                              onClick={() => approveProduct(item.id)}
                              className="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition text-sm"
                            >
                              ‚úì Approve
                            </button>
                            <button
                              onClick={() => rejectProduct(item.id)}
                              className="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition text-sm"
                            >
                              ‚úó Reject
                            </button>
                          </>
                        )}
                        <button
                          onClick={() => removeProduct(item.id)}
                          className="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-100 transition text-sm"
                        >
                          Remove
                        </button>
                      </div>
                    </div>
                  ))}
                </div>
              )}
            </div>
          )}
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<Dashboard />);
  </script>
</body>
</html>
